width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "black", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
injury_locations <- data.frame(
x = c(0.46, 0.45, 0.47, 0.47, 0.5, 0.45, 0.5, 0.45, 0.5, 0.34, 0.45, 0.36, 0.35, 0.5, 1, 0),
y = c(0.3, 0.4, 0.06, 0.2, 0.5, 0.01, 0.65, 0.48, 0.95, 0.51, 0.68, 0.62, 0.55, 0.6, 1, 0),
injury_count = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 5, 5)
)
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "black", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
injury_locations <- data.frame(
x = c(0.46, 0.45, 0.47, 0.47, 0.5, 0.45, 0.5, 0.45, 0.5, 0.34, 0.45, 0.36, 0.33, 0.5, 1, 0),
y = c(0.3, 0.4, 0.06, 0.2, 0.5, 0.01, 0.65, 0.48, 0.95, 0.51, 0.68, 0.62, 0.45, 0.6, 1, 0),
injury_count = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 5, 5)
)
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "black", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
injury_locations <- data.frame(
x = c(0.46, 0.45, 0.47, 0.47, 0.5, 0.45, 0.5, 0.45, 0.5, 0.34, 0.45, 0.36, 0.33, 0.5, 1, 0),
y = c(0.3, 0.4, 0.06, 0.2, 0.5, 0.01, 0.65, 0.48, 0.95, 0.51, 0.68, 0.62, 0.45, 0.6, 1, 0),
injury_count = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 5, 5)
)
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "black", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
injury_locations <- data.frame(
x = c(0.46, 0.45, 0.47, 0.47, 0.5, 0.45, 0.5, 0.45, 0.5, 0.34, 0.45, 0.36, 0.33, 0.5, 1, 0),
y = c(0.3, 0.4, 0.06, 0.2, 0.5, 0.01, 0.65, 0.48, 0.95, 0.51, 0.68, 0.55, 0.45, 0.6, 1, 0),
injury_count = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 5, 5)
)
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "black", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
injury_locations <- data.frame(
x = c(0.46, 0.45, 0.47, 0.47, 0.5, 0.45, 0.5, 0.45, 0.5, 0.34, 0.45, 0.36, 0.33, 0.5, 1, 0),
y = c(0.3, 0.4, 0.06, 0.2, 0.5, 0.01, 0.65, 0.48, 0.95, 0.51, 0.68, 0.57, 0.45, 0.6, 1, 0),
injury_count = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 5, 5)
)
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "black", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
injury_locations <- data.frame(
x = c(0.46, 0.45, 0.47, 0.47, 0.5, 0.45, 0.5, 0.45, 0.5, 0.34, 0.45, 0.36, 0.33, 0.5, 1, 0),
y = c(0.3, 0.4, 0.06, 0.2, 0.5, 0.01, 0.65, 0.48, 0.95, 0.51, 0.68, 0.6, 0.45, 0.6, 1, 0),
injury_count = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 5, 5)
)
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "black", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
injury_locations <- data.frame(
x = c(0.46, 0.45, 0.47, 0.47, 0.5, 0.45, 0.5, 0.45, 0.5, 0.34, 0.45, 0.36, 0.33, 0.5, 1, 0),
y = c(0.3, 0.4, 0.06, 0.2, 0.5, 0.01, 0.65, 0.48, 0.95, 0.51, 0.68, 0.59, 0.45, 0.6, 1, 0),
injury_count = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 5, 5)
)
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "black", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
injury_locations <- data.frame(
x = c(0.46, 0.45, 0.47, 0.47, 0.5, 0.45, 0.5, 0.45, 0.5, 0.34, 0.45, 0.36, 0.33, 0.37, 1, 0),
y = c(0.3, 0.4, 0.06, 0.2, 0.5, 0.01, 0.65, 0.48, 0.95, 0.51, 0.68, 0.59, 0.45, 0.63, 1, 0),
injury_count = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 5, 5)
)
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "black", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
injury_locations <- data.frame(
x = c(0.46, 0.45, 0.47, 0.47, 0.5, 0.45, 0.5, 0.45, 0.5, 0.34, 0.45, 0.35, 0.33, 0.37, 1, 0),
y = c(0.3, 0.4, 0.06, 0.2, 0.5, 0.01, 0.65, 0.48, 0.95, 0.51, 0.68, 0.58, 0.45, 0.63, 1, 0),
injury_count = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 5, 5)
)
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "black", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
injury_locations <- data.frame(
x = c(0.46, 0.45, 0.47, 0.47, 0.5, 0.45, 0.5, 0.45, 0.5, 0.34, 0.45, 0.355, 0.33, 0.37, 1, 0),
y = c(0.3, 0.4, 0.06, 0.2, 0.5, 0.01, 0.65, 0.48, 0.95, 0.51, 0.68, 0.58, 0.45, 0.63, 1, 0),
injury_count = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 5, 5)
)
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "black", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
injury_locations <- data.frame(
x = c(0.46, 0.45, 0.47, 0.47, 0.5, 0.45, 0.5, 0.45, 0.5, 0.34, 0.45, 0.355, 0.33, 0.37, 1, 0),
y = c(0.3, 0.4, 0.06, 0.2, 0.5, 0.01, 0.65, 0.48, 0.95, 0.51, 0.68, 0.58, 0.45, 0.63, 1, 0),
injury_count = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 5)
)
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "black", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
injury_locations <- data.frame(
x = c(0.46, 0.45, 0.47, 0.47, 0.5, 0.45, 0.5, 0.45, 0.5, 0.34, 0.45, 0.355, 0.33, 0.37),
y = c(0.3, 0.4, 0.06, 0.2, 0.5, 0.01, 0.65, 0.48, 0.95, 0.51, 0.68, 0.58, 0.45, 0.63),
injury_count = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
)
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "black", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
0, 1, 0, 1) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "black", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
0, 2, 0, 1) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "black", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-1, 1, 0, 1) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "black", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
injury_locations <- data.frame(
x = c(0.46, 0.45, 0.47, 0.47, 0.5, 0.45, 0.5, 0.45, 0.5, 0.34, 0.45, 0.355, 0.33, 0.37, 0.1. 0, 1),
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "black", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
injury_locations <- data.frame(
x = c(0.46, 0.45, 0.47, 0.47, 0.5, 0.45, 0.5, 0.45, 0.5, 0.34, 0.45, 0.355, 0.33, 0.37, 0.1, 0, 1),
y = c(0.3, 0.4, 0.06, 0.2, 0.5, 0.01, 0.65, 0.48, 0.95, 0.51, 0.68, 0.58, 0.45, 0.63, 0.2, 0, 1),
injury_count = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 5)
)
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "black", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
injury_locations <- data.frame(
x = c(0.46, 0.45, 0.47, 0.47, 0.5, 0.45, 0.5, 0.45, 0.5, 0.34, 0.45, 0.355, 0.33, 0.37, 0.5, 0, 1),
y = c(0.3, 0.4, 0.06, 0.2, 0.5, 0.01, 0.65, 0.48, 0.95, 0.51, 0.68, 0.58, 0.45, 0.63, 0.6, 0, 1),
injury_count = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 5)
)
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "black", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
injury_locations <- data.frame(
x = c(0.46, 0.45, 0.47, 0.47, 0.5, 0.45, 0.5, 0.45, 0.5, 0.34, 0.45, 0.355, 0.33, 0.37, 0.5, 0, 1),
y = c(0.3, 0.4, 0.06, 0.2, 0.5, 0.01, 0.65, 0.48, 0.95, 0.51, 0.68, 0.58, 0.45, 0.63, 0.58, 0, 1),
injury_count = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 5)
)
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "black", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
injury_locations <- data.frame(
x = c(0.46, 0.45, 0.47, 0.47, 0.5, 0.45, 0.5, 0.45, 0.5, 0.34, 0.45, 0.355, 0.33, 0.37, 0.5, 0, 1),
y = c(0.3, 0.4, 0.06, 0.2, 0.5, 0.01, 0.65, 0.48, 0.95, 0.51, 0.68, 0.58, 0.45, 0.63, 0.58, 0, 1),
injury_count = c(t$count, 1, 1)
)
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "black", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "pink", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
injury_locations <- data.frame(
x = c(0.46, 0.45, 0.47, 0.47, 0.5, 0.45, 0.5, 0.45, 0.5, 0.34, 0.45, 0.355, 0.33, 0.37, 0.5, 0, 1),
y = c(0.3, 0.4, 0.06, 0.2, 0.5, 0.01, 0.65, 0.48, 0.95, 0.51, 0.68, 0.58, 0.45, 0.63, 0.58, 0, 1),
injury_count = c(t$count, 0, 0)
)
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "pink", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "magenta", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.8)) +
scale_color_gradient(low = "magenta", high = "darkred") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.9)) +
scale_color_gradient(low = "magenta", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.9)) +
scale_color_gradient(low = "white", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
library(dplyr)
library(tidyr)
library(ggplot2)
library(png)
library(grid)
# Get dimensions
image_dim <- dim(body_image)
width <- image_dim[2]
height <- image_dim[1]
height
injury_locations <- data.frame(
x = c(0.46, 0.45, 0.47, 0.47, 0.5, 0.45, 0.5, 0.45, 0.5, 0.34, 0.45, 0.355, 0.33, 0.37, 0.5),
y = c(0.3, 0.4, 0.06, 0.2, 0.5, 0.01, 0.65, 0.48, 0.95, 0.51, 0.68, 0.58, 0.45, 0.63, 0.58),
injury_count = c(t$count)
)
injury_locations$normalized_count <- (injury_locations$injury_count - min(injury_locations$injury_count)) /
(max(injury_locations$injury_count) - min(injury_locations$injury_count))
# Interpolating data for the heatmap
interp_data <- with(injury_locations,
interp(x, y, normalized_count,
xo = seq(0, width, length.out = 100),
yo = seq(0, height, length.out = 100)))
install.packages("akima")
library(akima)
# Interpolating data for the heatmap
interp_data <- with(injury_locations,
interp(x, y, normalized_count,
xo = seq(0, width, length.out = 100),
yo = seq(0, height, length.out = 100)))
# Create a data frame from the interpolated data
heatmap_data <- expand.grid(x = interp_data$x, y = interp_data$y)
heatmap_data$z <- as.vector(interp_data$z)
# Create the heatmap overlay
ggplot() +
# Add the body image as background
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
# Add the heatmap
geom_raster(data = heatmap_data, aes(x = x, y = y, fill = z), interpolate = TRUE) +
scale_fill_gradient(low = "white", high = "red", na.value = "transparent") + # Color scale
labs(title = "Football Player Injuries Heatmap on Human Body") +
theme_void()
# Create the heatmap overlay
ggplot() +
# Add the body image as background
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
# Add the heatmap
geom_raster(data = heatmap_data, aes(x = x, y = y, fill = z), interpolate = TRUE) +
scale_fill_gradient(low = "black", high = "red", na.value = "transparent") + # Color scale
labs(title = "Football Player Injuries Heatmap on Human Body") +
theme_void()
View(heatmap_data)
View(interp_data)
# Interpolating data for the heatmap
interp_data <- with(injury_locations,
interp(x, y, normalized_count,
xo = seq(0, width, length.out = 100),
yo = seq(0, height, length.out = 100)))
View(interp_data)
injury_locations <- data.frame(
x = c(0.46, 0.45, 0.47, 0.47, 0.5, 0.45, 0.5, 0.45, 0.5, 0.34, 0.45, 0.355, 0.33, 0.37, 0.5)*width,
y = c(0.3, 0.4, 0.06, 0.2, 0.5, 0.01, 0.65, 0.48, 0.95, 0.51, 0.68, 0.58, 0.45, 0.63, 0.58)*height,
injury_count = c(t$count)
)
injury_locations$normalized_count <- (injury_locations$injury_count - min(injury_locations$injury_count)) /
(max(injury_locations$injury_count) - min(injury_locations$injury_count))
# Interpolating data for the heatmap
interp_data <- with(injury_locations,
interp(x, y, normalized_count,
xo = seq(0, width, length.out = 100),
yo = seq(0, height, length.out = 100)))
View(interp_data)
View(injury_locations)
interp_data[["z"]]
ggplot() +
# Add the body image as background
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
# Add the heatmap using kernel density estimation
stat_density_2d(data = injury_locations,
aes(x = x, y = y, fill = after_stat(density)),
geom = "raster",
contour = FALSE) +
# Add color gradient (adjust to suit)
scale_fill_gradient(low = "white", high = "red") +
# Add title and clean up the plot
labs(title = "Football Player Injuries Heatmap on Human Body") +
theme_void()  # Remove axes and background
library(dplyr)
library(tidyr)
library(ggplot2)
library(png)
library(grid)
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.9)) +
scale_color_gradient(low = "white", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
. <- premier_player_injuries %>%
select(injury) %>% distinct() %>% fliter()
View(.)
injury_locations <- data.frame(
x = c(0.46, 0.45, 0.47, 0.47, 0.5, 0.45, 0.5, 0.45, 0.5, 0.34, 0.45, 0.355, 0.33, 0.37, 0.5, 0, 1),
y = c(0.3, 0.4, 0.06, 0.2, 0.5, 0.01, 0.65, 0.48, 0.95, 0.51, 0.68, 0.58, 0.45, 0.63, 0.58, 0, 1),
injury_count = c(t$count, 0, 0)
)
ggplot() +
annotation_custom(rasterGrob(body_image,
width = unit(1, "npc"),
height = unit(1, "npc")),
-Inf, Inf, -Inf, Inf) +
theme_void() + geom_point(data = injury_locations,
aes(x = x, y = y, size = injury_count,
color = injury_count, alpha = 0.9)) +
scale_color_gradient(low = "white", high = "red") +
scale_size(range = c(5, 20)) +
labs(title = "Injury Heatmap on Human Body")
